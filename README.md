# PCAP 网络扫描器 (pcap_scanner_go)

这是一款基于 Go 语言开发的高性能网络扫描工具。它能从 PCAP 文件中读取报文作为模板，并将其发送到指定的目标 IP 地址范围。该工具还支持响应捕获，可广泛用于网络探测、服务发现和安全审计等场景。

## 主要功能

*   **基于 PCAP 模板：** 使用由 `tcpdump` 或 Wireshark 等工具捕获的 PCAP 文件作为任何协议的报文模板。
*   **灵活的目标指定：** 支持三种格式的目标 IP 地址：
    *   **CIDR:** `192.168.1.0/24`
    *   **IP 范围:** `192.168.1.1-192.168.1.100`
    *   **单个 IP:** `192.168.1.1`
*   **响应捕获：** 可选地监听网络接口，捕获与已发送报文匹配的响应，并将其保存到带有时间戳的 PCAP 文件中。
*   **速率控制：** 通过 `-pps` 参数精确控制每秒发送的报文数量，以适应不同的网络环境和扫描需求。
*   **自动源 IP：** 如果不指定源 IP 地址，工具会自动选择指定网络接口上的第一个可用的 IPv4 地址。

## 参数说明

| 参数 | 描述 | 是否必需 | 默认值 |
| :--- | :--- | :--- | :--- |
| `-srcIP` | 指定发送报文的源 IP 地址 (IPv4 或 IPv6)。如果留空，将自动从接口选择。 | 否 | 无 |
| `-target` | 指定目标 IP 地址。支持 CIDR、范围或单个 IP 格式。 | 是 | 无 |
| `-pcap` | 作为报文模板的 PCAP 文件路径。 | 是 | 无 |
| `-iface` | 用于发送和接收报文的网络接口名称 (例如 `eth0`)。 | 是 | 无 |
| `-capture` | 启用响应捕获。匹配的响应将被保存到 `response_YYYYMMDD_HHMMSS.pcap` 文件中。 | 否 | `false` |
| `-pps` | 每秒发送的报文数量。`0` 表示无限制，以最快速度发送。 | 否 | `0` |
| `-version` | 显示版本信息并退出。 | 否 | `false` |

## 使用示例

### 1. 基本扫描

从 `template.pcap` 文件读取报文，发送到 `192.168.1.0/24` 网段，使用 `eth0` 接口。

```bash
sudo ./pcap_scanner_go -pcap template.pcap -target 192.168.1.0/24 -iface eth0
```

### 2. 启用响应捕获

扫描 `10.0.0.1` 到 `10.0.0.100` 的 IP 范围，并捕获响应。

```bash
sudo ./pcap_scanner_go -pcap template.pcap -target 10.0.0.1-10.0.0.100 -iface eth0 -capture
```

### 3. 限制发送速率

以每秒 1000 个报文的速率进行扫描。

```bash
sudo ./pcap_scanner_go -pcap template.pcap -target 192.168.1.1 -iface eth0 -pps 1000
```

### 4. 查看版本信息

```bash
./pcap_scanner_go -version
```

## 如何编译

请确保你的系统已安装 Docker。

```bash
# 运行构建脚本
./build.sh
```

构建脚本将会在 Docker 容器中编译项目，并将生成的可执行文件 `pcap_scanner` 拷贝到当前目录。
该脚本会自动注入当前日期的版本信息 (例如 `v25.10.20`)。
